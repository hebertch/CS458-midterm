RESEARCH ARTICLE Rosetta MSF a modular framework for multistate computational protein design Patrick Loffler Samuel Schmitz Enrico Hupfeld Reinhard Sterner Rainer Merkl Institute of Biophysics and Physical Biochemistry University of Regensburg Regensburg Germany These authors contributed equally to this work Current address Center for Structural Biology Department of Chemistry Vanderbilt University Nashville Tennessee United States of America rainermerkl@urde Abstract Computational protein design CPD is a powerful technique to engineer existing proteins or to design novel ones that display desired properties Rosetta is a software suite including algorithms for computational modeling and analysis of protein structures and offers many elaborate protocols created to solve highly specific tasks of protein engineering Most of Rosetta protocols optimize sequences based on a single conformation i e design state However challenging CPD objectives like multi specificity design or the concurrent consideration of positive and negative design goals demand the simultaneous assessment of multiple states This is why we have developed the multi state framework MSF that facilitates the implementation of Rosetta single state protocols in a multi state environment and made available two frequently used protocols Utilizing MSF we demonstrated for one of these protocols that multi state design yields a % higher performance than single state design on a ligand binding benchmark consisting of structural conformations With this protocol we designed de novo nine retro aldolases on a conformational ensemble deduced from a βα barrel protein All variants displayed measurable catalytic activity testifying to a high success rate for this concept of multi state enzyme design Author summary Protein engineering i e the targeted modification or design of proteins has tremendous potential for medical and industrial applications One generally applicable strategy for protein engineering is rational protein design based on detailed knowledge of structure and function computer programs like Rosetta propose the sequence of a protein possessing the desired properties So far most computer protocols have used rigid structures for design which is a simplification because a protein structure is more accurately specified by a conformational ensemble We have now implemented a framework for computational protein design that allows certain design protocols of Rosetta to make use of multiple design states like structural ensembles An in silico assessment simulating ligand binding design showed that this new approach generates more reliably native like sequences than a single state approach As a proof of concept we introduced de novo retro aldolase activity PLOS Computational Biology Junea a a a a OPEN ACCESS Citation Loffler P Schmitz S Hupfeld E Sterner R Merkl R Rosetta MSF a modular framework for multi state computational protein design PLoS Comput Biol e Editor Costas D Maranas The Pennsylvania State University UNITED STATES Received March Accepted May Published June Copyright © Loffler et al This is an open access article distributed under the terms of the Creative Commons Attribution License which permits unrestricted use distribution and reproduction in any medium provided the original author and source are credited Data Availability Statement All relevant data are within the paper and its Supporting Information files As described in S Text the benchmark datasets were deposited inbioinfurde downlMSF benchtargz Funding The authors received no specific funding for this work Competing interests The authors have declared that no competing interests exist into a scaffold protein and characterized nine variants experimentally all of which were catalytically active Introduction Since the s computational protein design CPD has been a powerful tool of protein engineering For example CPD has been successfully utilized to increase thermostability of proteins – and to design new or altered binding specificities for metals DNA or other ligands Additionally CPD was applied to even more challenging tasks like the design of novel protein protein interfaces de novo enzymes or artificial folds not found in nature Classical CPD methods referred to as single state design SSD optimize the amino acid sequence for the residue positions of a single backbone by means of an objective function A substantial contribution to the enormous success reached by SSD is due to refinements of the corresponding knowledge based or statistical energy terms and the incorporation of backbone flexibility However SSD is always a simplification because proteins populate conformational ensembles Moreover certain design objectives such as negative design – multi specificity design the design of specific protein interfaces or the mimicking of backbone flexibility require the concurrent assessment of several conformational or chemical states This is why multi state design MSD methodology is an emerging field in CPD that extends the application spectrum and promises high success rates Even the design of stable proteins profits from using backbone ensembles Typically the optimization strategy of MSD consists of an “outer routine” that suggests possible amino acids sequences and an “inner routine” that assesses the fitness of a given sequence by performing rotamer optimization on each of the considered states and combines the individual scores This combined score enables a sequence selection driven by the energetic contribution of multiple conformational andor chemical states For example in order to increase specificity of protein protein interactions one can utilize negative design and penalize those sequences that favor undesired interactions One of the first applications of MSD was the design of topologically specific coiled coil structures consisting of fold amino acid repeats whose stability was assessed by using terms of a standard molecular mechanics potential energy function Later on the binding pocket of a ribose binding protein was successfully redesigned by means of MSD based on a standard force field Meanwhile many of the common optimization algorithms used in SSD have been adapted for MSD including Monte Carlo MC with simulated annealing genetic algorithms the FASTER approach dead end elimination and cluster expansion Rosetta is currently the most flexible and most widely used CPD software suite and offers several multi state applications noteworthy are MPI MSD and RECON MPI MSD provides a generic multi state design implementation based on a genetic algorithm that optimizes a single sequence on multiple states given a fitness function RECON starts by individually optimizing one sequence for each state subsequently the computation of a consensus sequence is promoted by incrementally increasing convergence restraints However the current implementations of both methods are limited to certain design tasks and cannot make use of fine tuned protocols like those required for enzyme design or anchored design of protein protein interfaces In order to overcome this limitation we have developed MSF and our integration of this modular framework into Rosetta facilitates the transfer of already proven single state protocols to an MSD environment Here by using MSF we first corroborate the superiority of MSD for MSF A modular framework for multi state design PLOS Computational Biology Juneenzyme design based on two in silico benchmarks for ligand binding Applying the same protocol we then designed nine experimentally active retro aldolases Results and discussion Architecture of MSF MSF is a programming framework that allows the user to develop and execute Rosetta protocols in an MSD environment The modular software architecture of MSF significantly reduces the development efforts involved see Fig MSF requires as input a set of states s sn e g structural conformations and a population of sequences seq seqm which will be subsequently altered by the sequence optimizer The evaluator determines n state specific scores for each seqi according to the chosen Rosetta protocol These n × m scores are the input of a user defined fitness function which combines the scores to determine the fitness of each sequence and communicates these values to the sequence optimizer The task management is as follows for all protocols one process controls the sequence optimizer and a user defined number of evaluator processes execute the protocol Fig Software architecture of MSF This framework consists of two strictly separated modules the sequence optimizer and the evaluator The evaluator executes the chosen Rosetta protocol for each combination of a state sj and a sequence seqi The resulting scores are processed by the fitness function and transferred to the sequence optimizer Initially the user has to specify a number of states s sn and a set of initial sequences seq seqm MSF uses a GA to optimize the sequences according to their fitness To utilize a SSD protocol in an MSD environment the user has to adapt the protocol to the evaluator and specify a fitness functiong MSF A modular framework for multi state design PLOS Computational Biology Junein parallel which guarantees high scalability Technical details and availability are described in S Text MSF will be part of an upcoming weekly release of Rosetta As has been shown a genetic algorithm GA successfully samples sequence space in MSD calculations Therefore we have implemented the sequence optimizer based on the well proven GA of Rosetta Briefly a GA imitates the process of natural selection by maintaining a population of design sequences that are evolving for a number of generations while the selection pressure of the fitness function eliminates less optimal solutions The final output of MSF is a population of optimized sequences By contrast a standard SSD implementation that utilizes MC optimization generates one sequence Extending Rosetta protocols by MSD capability Both MSF and MPI MSD rely on the Rosetta GA However MPI MSD does not support the integration of existing SSD protocols such as enzyme design that requires the additional optimization of catalytic constraints Thus our aim was to offer a framework that minimizes the development effort of supplying SSD protocols with MSD capability The architecture of MSF strictly separates the tasks of optimization and the application specific assessment of states The resulting modularity allows an informed Rosetta user to implement MSD for existing protocols in a straightforward manner Most importantly the functionality of the protocols is unchanged and all options remain available In addition to protocol porting the user has to set up an application specific fitness function which defines the design goal If it is the goal to alter conformational binding or catalytic specificity the fitness function often has to consider positive and negative design For the assessment of one positive state s+ and one negative state s the following function has been proposed fitnessþ ðseqi Þ ¼ Dscoreþðseqi Þ w Dscore ðseqi Þ ðÞ Here scorel seqi is the difference of scores calculated for seqi and seq seq is the optimal sequence determined in an SSD for the states sl s+s and w is a weighting factor Similar approaches which were based on the computed transfer free energy from the target state to the ensemble of competing states or on differences of Rosetta energies guided the MSD of protein interfaces Equally to MPI MSD our framework MSF supports the specification of a broad range of fitness functions For the initial implementation of MSF we have integrated enzdes and AnchoredDesign two widely used Rosetta protocols enzdes provides ligand binding and enzyme design functionality by repacking and redesigning residues around the bindingactive site and by optimizing catalytic contacts AnchoredDesigncreates a protein interface by transferring a key interaction identified in a natural binding partner of the target protein to a surface loop of the scaffold protein Afterwards the surface of the scaffold is redesigned with backbone flexibility to generate a novel binding partner of the target To validate AnchoredDesignin the MSF context we redesigned the interface of the factor B serine protease domain from Homo sapiens PDB ID dle For this single example the MSD approach performed better that the corresponding SSD protocol see S Text for details In order to demonstrate the potential of MSF for a large number of cases we focused on enzdes by performing in silico and in vitro experiments For the in silico assessment the fitness of the sequences was computed according to Eq based on the Rosetta total score ts averaged over all states In the following we designate software protocols as program protocol For example Rosetta enzdes or for the sake of brevity enzdes and Rosetta MSF GA enzdes MSF GA enzdes are the names of the SSD and MSD implementations of enzdes MSF A modular framework for multi state design PLOS Computational Biology JuneMSD outperforms SSD in recapitulating a ligand binding site of an NMR ensemble The most obvious usage of MSD is its application to an ensemble representing the native conformations of a protein In solution a protein structure is dynamic and nuclear magnetic resonance NMR offers an experimentally determined estimation of protein dynamics Interestingly in previous analyses SSD protocols performed better on crystal structures than on NMR templates We speculated that this performance loss can be compensated if MSD is applied to a whole ensemble and we decided to assess a ligand binding design Thus for a first performance comparison of the SSD algorithm enzdes and the MSD algorithm MSF GA enzdeswe chose an NMR ensemble of the human intestinal fatty acid binding protein hIFABP with bound ketorolac PDB ID mji This ensemble consisting of ten conformations was prepared for ligand binding design see Materials and Methods and the design shell contained residue positions in the vicinity of the ligand Our protocol allowed Rosetta to find a low energy sequence by arbitrarily choosing residues for these positions For each of the individual conformations conf l randomly seeded runsl i of enzdes SSD were started Design quality was monitored by computing for each number of runs i the score ts hIFABP SSD ðiÞ This is the mean total score deduced from corresponding conformations Eq given in Rosetta Energy Units REU MSF GA enzdes MSD was applied to the full ensemble and the GA was started Analogously to the SSD experiment the mean total score ts hIFABP MSD ðjÞ was computed for each generation j Eq As a second measure of design quality we determined the native sequence similarity recovery nssr Commonly the performance of design algorithms is assessed by means of the native sequence recovery nsr – which is the fraction of identical residues at corresponding positions of the native and Fig Performance of SSD and MSD on the NMR ensemble hIFABP enzdes blue lines was executed for runs i for each of the ten conformations in the ensemble For each number of runs i the ts hIFABP SSD ðiÞ value dotted line is the mean of the ten lowest energy sequences Eq The corresponding nssr hIFABP SSD ðiÞ value solid line is the mean recovery value deduced from the same sequences Eq MSF GA enzdes orange lines was carried out for generations j on the whole ensemble using a population of sequences For each generation j the ts hIFABP MSD ðjÞ value dotted line is the mean of the ten lowest energy sequences of the corresponding population Eq The corresponding nssr hIFABP MSD ðjÞ value solid line is the mean recovery value deduced from the same sequences Eqg MSF A modular framework for multi state design PLOS Computational Biology Junethe designed sequence The concept of nsr is blind for a more specific comparison of residues beyond identity which may impede a detailed assessment In contrast for the computation of nssr all residue pairs reaching a BLOSUM score > are considered similar and contribute to the nssr value Eqs and The plots shown in Fig indicate that the SSD and the MSD algorithm converged after runs or generations respectively both with respect to sequence recovery and ts values of the chosen sequences The mean nsr values of enzdes and of MSF GA enzdeswere % and % and the mean nssr values were % and % Only two of the ten enzdes designs reached an nssr value % and % respectively that was higher than the mean nssr of MSF GA enzdesIn summary MSF GA enzdesperformed better than enzdes suggesting the usage of MSD if sequences have to be designed for an ensemble Altogether the energies of models generated in SSD were on average REU lower than those in MSD However a comparison of ts scores is no ideal means to compare SSD and MSD performance In MSD a sequence is a compromise that has to satisfy the constraints associated with all conformations in an acceptable manner In contrast SSD customizes a low energy sequence for each conformation Thus it is no surprise that the mean ts values of SSD sequences are superior to those of the MSD results On the other hand due to these specific adaptations based on single less native conformations the SSD sequences are receding from the native ones which are considered as close to optimal This undesired effect is less pronounced for MSD sequences computed on the whole native ensemble We conclude that nsr and nssr are more suitable than ts values for a comparative benchmarking of SSD and MSD approaches A novel benchmark dataset for ligand binding based on conformational sampling A standard dataset for the assessment of ligand binding and enzyme design is the enzdes scientific sequence recovery benchmark It consists of representative proteins in which the ligand is bound with an affinity of μM or lower During benchmarking a given CPD algorithm redesigns residues of the design shell enclosing each ligand and the algorithm ability to recapitulate the native sequence nsr and nssr values is measured However for an assessment of de novo design algorithms this approach may be misleading because the required remodeling of a chosen protein is more demanding than the recapitulation of its native binding pocket We created a more realistic benchmark that is devoid of a perfect backbonerotamer preorganization and is more suitable for the assessment of de novo design algorithms For feasibility reasons we randomly selected proteins prot k of the above benchmark proteins The corresponding ligands were removed and for each of the apoproteins an ensemble of conformations was created using the Backrub server which generates near native conformational ensembles Next by superposition of each conformation with the corresponding crystal structure the ligands were transferred to the binding pockets Thus the resulting dataset BR EnzBench featured for each of the prot k backbone conformations that are near to native but lack the implicit pre organization induced by a bound ligand in a crystal structure MSD outperforms SSD on a benchmark dataset mimicking de novo design applications We used BR EnzBench to compare the performance of SSD and MSD for de novo ligand binding design All design shell residues were initially mutated to alanine and the conformations MSF A modular framework for multi state design PLOS Computational Biology Junewere energy minimized to further increase the difficulty for CPD algorithms to recover the native sequence To prevent a hydrophobic collapse of the alanine only design shells minimization was performed with backbone constraints Thus the CPD problem to be solved within the scope of this benchmark was to design a binding pocket by sequence optimization of the all alanine design shells For SSD with enzdes all conformations of each protein were considered independently and for each conformation randomly seeded designs were performed Design quality was assessed by means of the three parameters nsr nssr and ts The respective values were averaged for each of the prot k Eqs and and are listed in Table Additionally the convergence of the design process was followed by monitoring the mean performance for each number i of design runs Eqs and these values are plotted in Fig To conduct multi state design by means of MSF GA enzdesfor each prot k the conformations were divided into four ensembles ensk m each containing five conformations Note that the conformations that are combined in each of the ensembles ensk m are unrelated due to the stochastic approach of the Backrub algorithm The GA was started on a population consisting of sequences and stopped after generations because convergence was reached Analogously nsr nssr and ts values Eqs and were determined for each MSD run and averaged for each of the proteins These results were added to Table As above the convergence of the GA was followed be monitoring the mean performance for each generation j Eqs and these values are also plotted in Fig The protein wise comparison Table indicates that in out of the cases the nsr and in out of all cases the nssr values of MSF GA enzdesdesigns are superior to the corresponding values of enzdes designs MSF GA enzdesrecovers on average a higher percentage of native residues nsr = % and a higher percentage of similar residues Table Performance of SSD and MSD for individual proteins from BR EnzBench PDB ID nsr % nssr % ts REU enzdes MSF GA enzdes enzdes MSF GA enzdes enzdes MSF GA enzdes fzq hsl jz nh nq opb pot urg bb dri ifb qy qo rct rde uyi Average nsr nssr and ts values were determined for each of the proteins from BR EnzBench after convergence of enzdes and MSF GA enzdes For details see Materials and Methodst MSF A modular framework for multi state design PLOS Computational Biology Junenssr = % Thus with respect to the more adequate similarity measure nssr MSD performs % better than SSD for this benchmark p = Wilcoxon signed rank test In addition multi state designs have slightly better energies ts = REU which is in contrast to the hIFABP results and is most likely due to the smaller ensemble size Fig reflects the differences in convergence speed of both algorithms and indicates that the better performance has its price the MC optimization utilized by enzdes leads to acceptable design solutions even after a low number of runs In contrast the GA of MSF GA enzdesis slower and more than hundred generations are required to surpass the performance of the SSD algorithm For this set of parameters MSF GA enzdesrequired approximately five times the number of core hours needed by enzdes further details of computational costs are given in S Text The MSD concept is crucial for performance on BR EnzBench The sequence recovery reached for the hIFABP ensemble and for BR EnzBench strongly suggests that MSF GA enzdesis superior to enzdes in more complex design applications However it was unclear to us whether the different concepts single state versus multi state or the different optimizers MC versus GA contributed most to performance Choosing an MSD approach increases computational cost which has to be substantiated by making plausible that the choice of the optimizer is less important The performance of MSF GA enzdeson BR EnzBench was assessed ensemble wise by determining the values nssrMSDðensk mÞ which were averaged Eq As these ensembles contain not more than five unrelated conformations each the nssrMSDðensk mÞ values Eq vary due to the small sample size and one can sort for each prot k the four ensk m on their nssrMSDðensk mÞ value The result is a ranking ensk rank¼u u of the four ensembles and we created the set ES that contained the ensembles one for each prot k with the lowest Fig Convergence of SSD and MSD algorithms on the benchmark set BR EnzBench enzdes blue lines was executed for runs i on all conformations of each prot k from BR EnzBench For each number of runs i the ts BR EB SSD ðiÞ value dotted line is the mean of the twenty lowest energy sequences Eq The corresponding nssr BR EB SSD ðiÞ value solid line is the mean recovery value deduced from the same sequences Eq MSF GA enzdes orange lines was carried out for generations j on all ensembles using a sequence population of For each generation j the ts BR EB MSD ðjÞ value dotted line is the mean of the five lowest energy sequences of each of the four protein specific ensembles Eq The corresponding nssr BR EB MSD ðjÞ value solid line is the mean recovery value deduced from the same sequences Eqg MSF A modular framework for multi state design PLOS Computational Biology JunenssrMSDðensk mÞ value Analogously we compiled the sets ES—ES consequently ES consisted of those ensembles that had the highest nssrMSDðensk mÞ value for details see Materials and Methods For these four sets ESi we determined boxplots of the corresponding nssrSSD and nssrMSD values see Fig The boxplots characterizing the SSD results are nearly identical this finding indicates that the conformations allocated to the four sets ES—ES give rise to a similar SSD performance Moreover the boxplots representing the nssrSSD ES and nssrMSD ES values are nearly identical median values % and % which indicates that the optimizer GA is not generally superior to MC Additionally the continuous increase observed for the nssrMSD ES nssrMSD ES but not for the nssrSSD ES – nssrSSD ES values supports the notion that it is the combination of conformations that strongly affects MSD performance We thus conclude that the MSD approach and not the optimizer contributes most to the performance of MSF GA enzdes The residue preferences of enzdes and MSF GA enzdesdiffer Because Rosetta has a certain bias in recapitulating native residues we assessed and compared the bias introduced by enzdes and MSF GA enzdes For the assessment of the enzdes outcome we selected the sequences representing the best designs on BR EnzBench and determined nssrSSD aaj values This distribution represents for all amino acids aaj the fraction of similar residues recovered at all design shell positions Analogously the distribution nssrMSD aaj was computed that indicates the fraction of similar residues recovered by MSF GA enzdes for details see Materials and Methods The two distributions which are plotted in Fig indicate similar recovery rates that are below the optimal value of % for all residues Generally sequence recovery for large polar or charged residues D E H K N R S is low which contributes to Rosetta weakness in Fig Performance of enzdes and MSF GA enzdes on a distinct grouping of conformations Each of the sets ES—ES contains a quarter of the conformations from BR EnzBench which were grouped according to their nssrMSD values Eq ES contains all ensembles with the lowest and ES those with the largest recovery values For each set ESi the corresponding nssrSSD ESi and nssrMSD ESi values are represented by two boxplots Left performance of enzdes blue boxplots right performance of MSF GA enzdes orange boxplots Whiskers indicate the lowest and the highest datum still within the interquartile rangeg MSF A modular framework for multi state design PLOS Computational Biology Juneaccurately designing hydrogen bonds and electrostatics Interestingly enzdes is slightly better in recovering polar and charged residues whereas MSF GA enzdesclearly recovers a higher fraction of hydrophobic residues A F I L P V W Y This general trend is most evident in the two benchmark proteins with the most extreme differences in their individual nssrSSD and nssrMSD values ARL GDP PDB ID fzq is a distinct GTP binding protein from Mus musculus and both the ligand and the native binding pocket are considerably polar Fig A shows that enzdes correctly recovers the residues interacting with the guanine group colored in teal of GDP while MSF GA enzdesis less successful On the other hand in the glucose binding protein PDB ID bb from Thermus thermophilus four tryptophan residues provide tight binding to glucose by shape complementarity Fig B shows that MSF GA enzdes recovers three critical tryptophan residues colored in teal in most designs whereas enzdes prefers small polar residues that do not provide tight packing We conclude that the representation of a protein by means of an ensemble improves hydrophobic packing but not the formation of polar interaction networks Their design is considerably more difficult than hydrophobic packing due to the partially covalent nature of a hydrogen bond and the geometric requirements for orientations and distances Molecular dynamics simulations are well suited to create conformational ensembles Molecular dynamics MD simulation is a well established and reliable method for modeling conformational changes linked to the function of proteins Thus MD provides an alternative to the Backrub approach for the generation of ensembles to be utilized in MSD We were interested in assessing the designability of conformations resulting from unconstrained MD simulations of length ns In analogy to BR EnzBench we compiled the dataset MD EnzBench consisting of conformations generated for each of the benchmark apoproteins by means of YASARA Again all design shell residues were replaced with alanine prior to design see Materials and Methods Fig Recovery of design shell residues from BR EnzBench by means of enzdes and MSF GA enzdes The distributions nssrSSD aaj blue bars and nssrMSD aaj orange bars represent for each amino acid aaj the nssr value Eq deduced from design sequences These were created by enzdes or MSF GA enzdes for the benchmark proteins BR EnzBench respectively nssr takes into account the recovery of all residues which are similar to the native aajg MSF A modular framework for multi state design PLOS Computational Biology JuneTo assess the structural variability of MD EnzBench conformations Cα RMSD values of design shell residues were determined in a protein specific all against all comparison and then averaged Analogously the structural variability of BR EnzBench conformations was determined Interestingly the variety of the binding pockets generated by the MD simulations is much larger than that generated by Backrub the mean RMSD of MD EnzBench is Å and that of BR EnzBench is Å which indicates that a ns MD simulation generates an ensemble with higher structural diversity than the Backrub server As a control of design performance the × nssrBR EB SSD ði ¼ Þ values of single enzdes designs generated for protein specific conformations from BR EnzBench were summarized in a boxplot which had a mean value of % To assess the designability of the MD EnzBench conformations for each of the protein specific conformations one sequence was Fig Recovery of two striking binding pockets by means of enzdes and MSF GA enzdes a The D structure of the binding pocket of ARL GDP is shown on the right the ligand GDP is colored light blue The residues of the corresponding design positions are shown on the left labeled “Native” The sequence logos labeled enzdes and MSF GA enzdes represent for each design position the distribution of residues as generated by the corresponding protocols Residues that are similar to the native ones are colored in green In the native sequence residues are colored in teal if the outcome of the two protocols differs drastically b The D structure of the binding pocket of the glucose binding protein is shown on the right the bound glucose is colored light blue Native residues and sequence logos are shown on the left and were prepared and colored as described for panel ag MSF A modular framework for multi state design PLOS Computational Biology Junedesigned by means of enzdes and the resulting nssr values were averaged protein wise Fig shows boxplots each representing × nssr values resulting from ten conformations generated by the MD simulation in a ps interval for each of the prot k The mean of these nssr values is % which testifies to a satisfying design performance given that only one sequence was designed for each MD conformation Moreover the boxplots indicate that performance did not decrease for conformations generated at later phases of the MD simulation the median nssr and the first and third quartile of the most left and the most right boxplots are % % % and % % % respectively In summary these findings suggest that ensembles generated by MD feature higher conformational flexibility and appropriate de novo designability A multi state de novo design of retro aldolases The most convincing proof of concept for any CPD algorithm is the design of functionally active proteins A non natural reaction that is frequently chosen for enzyme design is the amine catalyzed retro aldole cleavage of hydroxy methoxy naphtyl butanone methodol into methoxy naphthaldehyde and acetone This multi state reaction comprises the attack of an active site lysine side chain on the carbonyl group of the substrate to form a carbinolamine intermediate that is subsequently dehydrated to a protonated Schiff base The latter is then converted to the reaction products by acidbase chemistry The most active de novo retro aldolase designs have been established on a jelly roll and several βα barrel proteins – For comparison purposes we selected the indole glycerolphosphate synthase from Sulfolobus solfataricus ssIGPS a previously used thermostable βα barrel scaffold The native ligand was removed and the apoprotein was subjected to conformational sampling Using the protocol validated with MD EnzBench three individual MD simulations were performed for ns A clustering of MD snapshots based on RMSD values helps to choose near native conformations Thus we used Durandal to cluster the snapshots conformations generated with each MD run and picked four conformations from the largest cluster These × conformations and the crystal structure of the apoprotein constituted the structural ensemble for the subsequent enzyme design Enzyme design generally starts with the assembly of a theozyme which is a model for the proposed active site that is based upon the geometric constraints dictated by the expected transition state s To design retro aldolase catalysis we used a previously designed theozyme containing the carbinolamine reaction intermediate as transition state surrogate covalently bound to the catalytic lysine In addition this theozyme contained an aspartate or a glutamate residue to function as general acidbase as well as a serine or a threonine residue to provide additional hydrogen bonding interactions Rosetta matchwas applied to all conformations and created several thousand matched transition states mTS with catalytic triads Ki D E j ST k located at markedly different residue positions A critical step of MSD is the compilation of the ensembles that are concurrently used as states For enzyme design ensembles ensmTS of mTS are needed and we compiled them the following way first mTS judged as binding the transition state only weakly were discarded Second mTS derived from different conformations were added to the same ensmTS if identical catalytic triads were located at matching residue positions Thus each ensmTS contained a certain number of conformations accommodating the same catalytic triad Third the consistency of each ensmTS was assessed by superposing the transition states and by comparing the corresponding conformations We chose ensmTS consisting of to conformations states and their design and repack shells were defined by merging the output created by enzdes autodetectfor all conformations MSF GA enzdeswas executed with each ensemble until energetic convergence MSF A modular framework for multi state design PLOS Computational Biology Junesee S Text for details of the protocol In brief to assess the designs we compared active site geometry as well as total and interaction energies and the best variants were subjected to MD simulations of ns length For each variant we analyzed in detail catalytic site geometries of snapshots see Materials and Methods and nine variants named RA MSD to RA MSD were chosen for biochemical characterization see S Text Because the catalytic efficiency and the conformational stability of initial designs are generally poor further optimization is commonly performed by using either Foldit or other software tools to revert unnecessary mutations back to the native sequence of the scaffold or by means of directed evolution However we did not introduce subsequent stabilizing mutations into the sequences of RA MSD to RA MSD prior to a first experimental characterization In doing so we wanted to demonstrate the potential and also the limitations of multi state designs For a comparison of these novel designs with previous ones we compiled a list of retroaldolases RA from the literature see S Text that were also created in the ssIGPS scaffold by means of Rosetta These RA sequences differ on average at positions from the native ssIGPS sequence in contrast our nine RA MSD sequences contain on average amino acid substitutions Moreover RA sequences deviate on average from RA MSD sequences at positions and substitutions distinguish the most similar pairs of variants RA versus RA MSD and RA versus RA MSD Even a previous RA and a new design RA MSD which share the same catalytic residues K and S differ at positions Thus although we utilized the same TS and the same scaffold that was used for the design of RA—RA our MSD approach has generated a set of entirely novel catalytic sites located in the same shell as used for previous designs see Fig All initial MSD designs possess retro aldolase activity but need further processing to improve solubility The genes for RA MSD—RA MSD were synthesized and expressed in Escherichia coli as fusion constructs with the gene for the maltose binding protein MBP The fusion proteins Fig Single state designability of MD EnzBench conformations Each of the boxplots on the right represents × nssr values resulting from ten conformations generated by the MD simulation in a ps interval for each of the prot k As a control the × nssr BR EB SSD values of single enzdes designs generated for protein specific conformations from BR EnzBench were summarized in a boxplot shown on the left label Backrub Whiskers indicate the lowest and the highest values of the interquartileg MSF A modular framework for multi state design PLOS Computational Biology Junewere purified with metal chelate affinity chromatography via their N terminal hexa histidine tags resulting in high yields – mg proteinl expression culture RA MSD could be produced in soluble form also without MBP whereas the other designs precipitated in the absence of the solubility enhancer All designs showed modest catalytic activity with low substrate affinity leading to conversion rates in the presence of μM S methodol ranging from × to × s Table For the best designs namely RA MSD and RA MSD the linear part of the substrate saturation curve was used to determine kcatKM values of × and × M s S Fig Table which are similar to the values obtained for RA RA Moreover the RA MSD designs with and without MBP displayed virtually the same kcatKM values excluding an influence of the solubility enhancer on activity Fig Mutations introduced into the IGPS scaffold to design retro aldolase activity a An overview of all mutations introduced in previous designs subsumed in the set RA which are listed in S Text Blue spheres indicate residue positions and sphere diameters are proportional to the frequency of the mutations in comparison to the native IGPS sequence b Ditto for nine RA MSD designs mutations are visualized by means of orange spheresg Table MSD proteins and their retro aldolase activity Name Catalytic triad Number of mutations compared to ssIGPS Conversion rate s kcatKM M s RA MSD K D S × ND RA MSD K D S × ND RA MSD K D S × ND RA MSD K D S × ND RA MSD K D S × ND RA MSD K E S × ND RA MSD K E S × × RA MSD K E S × ND RA MSD K E T × × RA MSD K E T × ND RA MSD K E T × ND The catalytic triad designed for nine proteins RA MSD—RA MSD is specified in the second column The third column gives the number of residue exchanges compared to the native sequence of ssIGPS The fourth column lists the conversion rates rate of product formation divided by the enzyme concentration in the presence of μM S methodol The last column gives the catalytic efficiency kcatKM as determined for RA MSD and RS MSD from the linear part of substrate saturation curves see S Fig ND not determinedt MSF A modular framework for multi state design PLOS Computational Biology JuneDue to the intentionally omitted step of secondary protein stabilization following the initial design process eight of our nine designs were insoluble without MBP We wanted to test whether protein stabilization would result in higher activity Accordingly we attempted to improve the stability of RA MSD which has the lowest activity of all designs Table by using the fully automated in silico method offered by the PROSS webserver The six conformations of RA MSD were individually submitted to PROSS and the corresponding output sets that contained to stabilizing mutations were merged to five consensus sequences see S Text Table B Variants RA MSD and RA MSD that contained the highest number of stabilizing mutations could be produced in soluble form without MBP and were purified with high yield about mg proteinl expression culture Activity measurements showed however that the additional stabilizing exchanges did not drastically improve the conversion rate of RA MSD see Table In summary our results show that MSD based on a structural ensemble is comparably successful as SSD based on a single structure for establishing retro aldolase activity on a thermostable βα barrel scaffold indicating that this particular reaction requires only a limited degree of conformational flexibility However catalysis is often linked to conformational transitions which can only be captured by MSD approaches Moreover in contrast to SSD MSD offers a broader functionality and is for example also suited for more challenging tasks like negative design Materials and methods Benchmark datasets BR EnzBench and MD EnzBench Two subsets of the scientific sequence recovery benchmark of Rosetta were generated that contain specifically prepared conformations of proteins prot k with bound ligand In order to exclude an erroneous conformational sampling missing residues were reconstructed by using YASARA loop modeling and the respective native sequences Additionally all ligands were removed prior to the conformational sampling of the resulting apoproteins The dataset BR EnzBench was created by using the BackrubEnsemblemethod of the Backrub server to compute a conformational ensemble of structures for each apoprotein The second benchmark dataset MD EnzBench was deduced from MD simulations of length ns generated with YASARA version and the YAMBER force field which has been parameterized to produce crystal structure like protein coordinates For each of the apoproteins conformations were sampled at an interval of ps After sampling the native ligands were re introduced in all conformations of both subsets by means of PyMOL superpose and the respective apoproteins For the corresponding holoproteins of BR EnzBench and MD EnzBench the same design and repack shells were utilized These were determined protein wise for each of the BR EnzBench conformations by means of Rosetta enzdes autodetect and merged In all conformations design shell residues were replaced with alanine and prior to design all conformations were energy minimized by means of Rosetta fastrelaxwith backbone constraints Parameters of MD simulations Rosetta fastrelax and the composition of design and repack shells are listed in S Text Genetic algorithm and fitness function The first generation of the sequences consisted of the given seed sequence and mutants each with a randomly introduced single point mutation During each generation cycle half of the population was replaced with sequences seqi generated by means of single point mutations and recombination The replaced sequences were those with worst fitness values fitness seqi MSF A modular framework for multi state design PLOS Computational Biology Junewhich were computed for MSF GA enzdesaccording to fitnessðseqi Þ ¼ n Xn l¼ tsl ðseqi Þ ðÞ Here n is the number of states e g conformations s sn of a given prot k and tsl is the Rosetta total score for a sequence given a state l In all equations ts values are given in REU Computing the native sequence similarity recovery For a given pair of residues aa aa the nssr value was deduced from the scores of the BLOSUM matrix as follows nssrðaa aaÞ ¼  if BLOSUMðaa aaÞ > else ðÞ For a given pair of sequences seq seq of length n the nssr value was determined as the mean value deduced for residue pairs seq i seq i nssrðseq seqÞ ¼ n Xn i¼ nssrðseq½i seq½iÞ ðÞ For a given set of design solutions ds = seq seqm and a native sequence seqnat the value nssr dsseqnat was computed according to nssrðds seqnatÞ ¼ m Xm i¼ nssrðseqi seqnatÞ ðÞ Assessing design performance on hIFABP The data set with PDB ID mji contains ten conformers of hIFABP and the bound ligand ketorolac this ensemble has been deduced by means of solution NMR The set was downloaded from PDB and the ligand was parameterized using Rosetta molfile toparams Next each of the ten conformations was energy minimized via Rosetta fastrelaxwith constraints To obtain consistent design and repack shells the shells determined by Rosetta enzdes autodetect for each conformation were merged For SSD enzdes was applied to each of the ten initial conformations conf l l Using the default MC optimization and the parameter set ps enzdes sequences seql i were generated by means of randomly seeded runsl i i In order to control the convergence of the design process and for performance comparison the seq l ðiÞ with the best total score ts were chosen from seql i for each l and each i Finally the mean of the ten ts values was determined as a measure of design quality ts hIFABP SSD ðiÞ reached in i SSD runs tshIFABP SSD ðiÞ ¼ X l¼ tsðseq l ðiÞÞ ðÞ For MSD all ten conformations conf l were considered as states and MSF GA enzdes was executed for generations i e design cycles on a population consisting of sequences with parameters ps msf enzdes The initial population was seeded with the native sequence The sequences representing a generation j were ranked with respect to ts values and the ten top scoring sequences seqt l ðjÞ t were stored in order to allow for the subsequent performance comparison Finally the mean of the × ts values was determined as a MSF A modular framework for multi state design PLOS Computational Biology Junemeasure of design quality ts hIFABP MSD ðjÞ reached in j MSD generations tshIFABP MSD ðjÞ ¼ X l¼ X t¼ tsðseqt l ðjÞÞ ðÞ Further details of the analysis can be found in S Text it lists parameters of Rosetta fastrelax and the design protocol and the composition of the design and repack shell Assessing design performance on BR EnzBench For SSD enzdes was applied to each of the initial conformations conf l l of each prot k k from BR EnzBench Using default MC optimization and the parameter set ps enzdes see S Text sequences l i were generated by means of randomly seeded runskl i i In order to control the convergence of the design process and for performance comparison those seq k l ðiÞ having the best ts value were chosen from l i for each k l and i Finally mean performance reached in i SSD runs was measured by means of the score nsrnssr where nsr is the native sequence recovery and nssr is the native sequence similarity recovery score BR EB SSD ðiÞ ¼ X k¼ X l¼ scoreðseq k l ðiÞ nat Þ ðÞ tsBR EB SSD ðiÞ ¼ X k¼ X l¼ tsðseq k l ðiÞÞ ðÞ Here nat is the native sequence of prot k and ts is the total score To score SSD performance reached for one prot k the final score values were averaged over all conformations score BR EB SSD ðkÞ ¼ X l¼ scoreðseq k l ðÞ natÞ ðÞ ts BR EB SSD ðkÞ ¼ X l¼ tsðseq k l ðÞÞ ðÞ To assess the performance of MSD each of the conformations of a prot k was assigned to an ensemble ensk m m consisting of five conformations each These five conformations were considered as states and MSF GA enzdeswas executed for generations on a population consisting of sequences with parameter set ps msf enzdes see S Text The initial population was seeded with an all alanine sequence The sequences representing a generation j were ranked with respect to ts values and the five top scoring sequences seqt k mðjÞ t were stored in order to allow for the subsequent performance comparison Finally mean performance values reached in j MSD generations were determined according to score BR EB MSD ðjÞ ¼ X k¼ X m¼ X t¼ scoreðseqt k mðjÞ natÞ ðÞ MSF A modular framework for multi state design PLOS Computational Biology Junets BR EB MSD ðjÞ ¼ X k¼ X m¼ X t¼ fitnessðseqt k mðjÞÞ ðÞ Here nat is the native sequence of prot k score nsrnssr is a sequence recovery and fitnessðseqt k mðjÞÞ is the mean ts score Eq n = of a given sequence over the five conformations belonging to ensemble ensk m To score MSD performance reached for one prot k after generations the final score values were averaged over all ensembles score BR EB MSD ðkÞ ¼ X m¼ X t¼ scoreðseqt k mðÞÞ ðÞ ts BR EB MSD ðkÞ ¼ X m¼ X t¼ fitnessðseqt k mðÞÞ ðÞ Grouping ensembles by MSD performance The conformations of a given protein prot k from BR EnzBench belong to one of four ensembles ensk ensk The performance values nssrMSDðensk mÞ were determined for each prot k and each ensk m according to nssrMSDðensk mÞ ¼ X t¼ nssrðseqt k mðÞ natÞ ðÞ Here nat is the native sequence of prot k The values nssrMSDðensk mÞ were used for a ranking ensk rank¼u u of the four ensembles such that ensk rank¼ is the one with the lowest nssrMSDðensk mÞ value and ensk rank¼ that with the largest one Having ranked the ensembles of all prot k sets of ensembles were created such that the set ES ¼ k¼ ensk rank¼ contained those ensembles that performed worst and ES ¼ k¼ ensk rank¼ those that performed best and the intermediates with rank = and rank = performed accordingly For these four sets ESi boxplots of the corresponding nssrSSD and nssrMSD values were determined Choosing sequences for the analysis of the sequence differences In order to assess the amino acid composition of the enzdes outcome the l with optimal ts values were identified for each of the conformations l of all prot k BR EnzBench For these × sequences SSD the values nssrð SSD½i nat½iÞ were determined Eq by comparing design shell and native nat residues i The distribution nssrSSD aaj represents for all amino acids aaj their recovered similarity at all design shell positions To assess the amino acid composition for the MSF GA enzdesoutcome the × × sequences MSD of the final populations i e all m generated for the four ensemble groups of each prot k BR EnzBench were used to determine the values nssrð MSD½i nat ½iÞ The distribution nssrMSD aaj represents for all amino acids aaj their recovered similarity at all design shell positions MSF A modular framework for multi state design PLOS Computational Biology JuneMulti state design of retro aldolases The scaffold protein indole glycerol phosphate synthase from S solfataricus ssIGPS PDB ID a was downloaded from PDB and the ligand IGP was removed To generate a structural ensemble three MD simulations were performed with the apoprotein for ns by means of YASARA and the YAMBER force field Using Durandal smart mode semi auto the snapshots of each trajectory were clustered individually and four conformations were chosen from the largest cluster These conformations and the crystal structure of a were used for matching the transition state TS and grafting the theozyme of the retroaldol reaction by means of Rosetta match Each of the resulting matched transition states mTS consisted of a catalytic triad Ki DE j ST k at three residue positions i j k that occured in one of the conformations Ensembles ensmTS of mTS used as input for MSF GA enzdeswere generated as follows first mTS were discarded that were classified as weak TS binders or TS destabilizers For example matches with catalytic residues near the protein surface were eliminated Second mTS were grouped according to the composition and localization of the catalytic triad and those ensembles were selected that were compatible with most of the conformations Third ensmTS were assessed with respect to the structural similarity of the superposed theozymes In total ensembles ensmTS containing up to conformations were chosen For each ensmTS the design and repack shells were defined by merging the outcome of Rosetta enzdes autodetect for all corresponding conformations and MSF GA enzdeswas executed on a population of sequences that were seeded with the native sequence of ssIGPS At convergence the design process was stopped which was the case after to generations S Text lists more details of the design procedure like parameters of MD simulations and of Rosetta match and the specification of the TS Evaluation of multi state design solutions After MSD of retro aldolases the designs were filtered by ts values and active site geometry The best designs were selected for ns MD simulations in water and for one conformation of each design ensemble snapshots were generated Two simulations were performed the first one was based on the enzymeTS complex As a control the second MD simulation was based on the enzymesubstrate complex and the substrate methodol was created by deleting the lysine substrate bond of the TS For each trajectory catalytic distances angles and torsion angles were plotted as boxplots and used to assess the designs see S Text PROSS stabilization Variant RA MSD was chosen for solubilization experiments and all six conformations conf l of the corresponding ensemble were submitted to the PROSS server which was used with default settings allowing for mutations at all positions For each input conf l PROSS provided seven mutated sequences mut seql i i containing an increasing number of putatively stabilizing mutations For each i degree of stabilization an MSA that contained all sequences mut seql i computed for all conf l was generated and weblogo was used to determine a sequence logo Finally consensus residues deduced from the sequence logos were accepted as mutations at sites that did not interfere with the catalytic center All sequence logos are shown in S Text Cloning gene expression and protein purification The genes encoding the designed retro aldolases were optimized for E coli codon usage and ordered as synthetic gene strings from Life Technologies Cloning was performed via BsaI MSF A modular framework for multi state design PLOS Computational Biology Junerestriction sites into pETa Stratagene and pMalCT New England Biolabs plasmids specifically modified for this method of cloning Both vectors fuse an N terminal his tag to the target proteins pMalCT additionally adds MBP The cloning method is derived from golden gate cloning Details of plasmid construction and cloning procedure will be published elsewhere E coli BL Gold cells were transformed with the resulting plasmids The cells were grown in Luria broth with μgml kanamycin or μgml ampicillin for pET constructs and pMAL constructs respectively At a cell density of OD = protein production was induced by addition of mM isopropyl β thiogalactopyranoside After growth over night at ˚C the cells were harvested by centrifugation Avanti J XP JLA min rpm ˚C Cell pellets were resuspended in mM TrisHCl buffer pH with mM NaCl Cells were lysed by sonication Branson Sonifier W D amplitude % min s pulse s pause Cell debris was removed by centrifugation Avanti J XP JA min rpm ˚C and soluble proteins were purified by nickel chelate affinity chromatography GE Healthcare HisTrap FF crude The proteins were eluted with mM TrisHCl pH containing mM NaCl using a gradient of – mM imidazole Fractions containing sufficiently pure protein were pooled and excess imidazole was removed by dialysis against mM TrisHCl pH buffer containing mM NaCl Protein concentrations were determined by absorbance spectroscopy NanoDrop One Thermo Fisher using extinction coefficients determined by the Expasy ProtParamwebtool Activity assay Retro aldolase activity of the designs – μM was measured at ˚C in mM TrisHCl pH mM NaCl and % vv dimethyl sulfoxide for substrate solubility by following the formation of the fluorescent product methoxy naphthaldehyde from non fluorescent S methodol % ee The substrate was synthesized as described in S Text Fluorescence was measured in a Mithras LB plate reader λex = nm λem = nm using black well micro plates The concentrations of product were determined with the help of a calibration curve For the determination of conversion rates each measurement was repeated four times for kcatKM determinations all points were measured as triplicates The wild type scaffold protein ssIGPS and the solubility tag MBP served as negative controls and did not show any detectable activity Further control measurements showed that conversion rates in the presence of % vv dimethyl sulfoxide were identical to those in % acetonitrile which has been used for the characterization of other retro aldolase designs 